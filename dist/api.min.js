import _ from"lodash";import axios from"axios";import{extend,Events,Deep,timeforce}from"timeforce";import{mix as mixRelational,relation,state}from"timeforce-relational";import{mix as mixFormat}from"timeforce-format";import{mix as mixValidate,validate}from"timeforce-validate";mixRelational(timeforce,timeforce.Collection,timeforce.Model);var timeforceApi=_.extend(_.omit(timeforce,"Model","Collection","View"));timeforceApi.name="API",timeforceApi._global=timeforceApi;var Model=timeforceApi.Model=timeforce.Model.extend({_global:timeforceApi}),Collection=timeforceApi.Collection=timeforce.Collection.extend({_global:timeforceApi});timeforceApi.axios=axios,timeforceApi.requestOptions={},timeforceApi.axios.defaults.headers=_.defaultsDeep({"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"},timeforceApi.axios.defaults.headers),timeforceApi.persist=function(e,o){var t=timeforceApi.axios.create(o);return new Promise(((o,i)=>{t[e.method](e.url,e.data,e).then((t=>{e.success(t.data||{}),o(t)})).catch((o=>{var t;t=o.response?[o.request,o.response.status,o.response.data]:[o.request,null,o.message],e.error.apply(null,t),i(t)}))}))};var sync={_global:timeforceApi,requestOptions:{},sync:function(){var e=_.concat(_.toArray(arguments),_.cloneDeep(this.requestOptions));return this._global.sync.apply(this,e)}};_.extend(timeforceApi.Model.prototype,sync),_.extend(timeforceApi.Collection.prototype,sync),timeforceApi.syncConfig=function(e){return _.defaultsDeep(e,timeforceApi.requestOptions)},mixFormat(timeforceApi.Collection,timeforceApi.Model),mixValidate(timeforceApi.Model),timeforceApi.configValidator=function(e,o="Invalid data"){timeforceApi.Model.prototype.validator=e,timeforceApi.Model.prototype.requiredErrorMessage=o};export{timeforceApi as timeforce,timeforceApi,Model,Collection,extend,Events,Deep,relation,state};export default timeforceApi;